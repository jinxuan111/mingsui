<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玄学·币运大师</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0f0c29;
            --bg-secondary: #302b63;
            --bg-tertiary: #24243e;
            --accent-neon: #00ff88;
            --accent-purple: #667eea;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0ff;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 40px 20px;
            background-attachment: fixed;
        }

        .container {
            max-width: 1500px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInDown 1s ease;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 56px;
            font-weight: 900;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-neon));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        .subtitle {
            font-size: 20px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-top: 10px;
            letter-spacing: 2px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1.4fr;
            gap: 50px;
            align-items: start;
        }

        .panel {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            animation: slideInLeft 0.8s ease;
        }

        .form-group {
            margin-bottom: 28px;
        }

        label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 16px;
            color: var(--accent-neon);
            letter-spacing: 1px;
        }

        input, select {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--accent-purple);
            border-radius: 12px;
            font-size: 17px;
            color: white;
            transition: all 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent-neon);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        button {
            width: 100%;
            padding: 18px;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-neon));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(0, 255, 136, 0.6);
        }

        .result-hidden {
            display: none;
        }

        .result-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }

        .result-card:hover {
            transform: translateY(-8px);
        }

        .result-card h3 {
            font-family: 'Orbitron', sans-serif;
            font-size: 24px;
            color: var(--accent-neon);
            margin-bottom: 24px;
            text-align: center;
            letter-spacing: 1.5px;
        }

        /* 币圈专属顶级卡片 */
        #cryptoCard {
            background: linear-gradient(135deg, #1a0033 0%, #0f0c29 100%);
            border: 2px solid var(--accent-neon);
            box-shadow: 0 0 40px rgba(0, 255, 136, 0.5);
            padding: 40px;
            border-radius: 24px;
            text-align: center;
        }

        #cryptoCard h3 {
            font-size: 32px;
            margin-bottom: 30px;
        }

        #cryptoAdvice {
            font-size: 20px;
            line-height: 2.2;
            text-align: left;
            white-space: pre-line;
        }

        .bazi-display {
            font-size: 28px;
            font-weight: 600;
            line-height: 2;
            text-align: center;
            padding: 30px;
            background: var(--glass);
            border-radius: 16px;
            border: 1px solid var(--glass-border);
        }

        .wuxing-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
        }

        .wuxing-item {
            background: var(--glass);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            border: 1px solid var(--glass-border);
            transition: all 0.3s;
        }

        .wuxing-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 255, 136, 0.3);
        }

        .wuxing-count {
            font-size: 42px;
            font-weight: 700;
            margin-top: 10px;
            color: var(--accent-neon);
        }

        .fortune-bar-container {
            margin-bottom: 30px;
        }

        .fortune-bar-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 18px;
        }

        .fortune-bar {
            height: 16px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }

        .fortune-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-neon));
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.6);
            transition: width 1.5s ease;
        }

        .analysis-text {
            background: var(--glass);
            padding: 28px;
            border-radius: 16px;
            line-height: 2;
            font-size: 17px;
            border: 1px solid var(--glass-border);
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .tab-btn {
            padding: 14px 32px;
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            font-weight: 600;
            font-size: 17px;
            cursor: pointer;
            transition: all 0.4s;
        }

        .tab-btn.active {
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-neon));
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .tab-btn:hover {
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-60px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            h1 { font-size: 42px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>玄学·币运大师</h1>
            <p class="subtitle">八字排盘 · 五行推演 · 专属土狗运势</p>
        </header>

        <div class="main-content">
            <!-- 输入面板 -->
            <div class="panel">
                <h2 style="text-align: center; font-family: 'Orbitron', sans-serif; font-size: 28px; margin-bottom: 40px; color: var(--accent-neon);">
                    输入出生信息
                </h2>

                <div class="form-group">
                    <label>出生年份</label>
                    <input type="number" id="year" min="1900" max="2026" value="1995">
                </div>

                <div class="form-group">
                    <label>出生月份</label>
                    <select id="month">
                        <option value="1">1月</option><option value="2">2月</option><option value="3">3月</option>
                        <option value="4">4月</option><option value="5">5月</option><option value="6">6月</option>
                        <option value="7">7月</option><option value="8">8月</option><option value="9">9月</option>
                        <option value="10">10月</option><option value="11">11月</option><option value="12">12月</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>出生日期</label>
                    <select id="day"></select>
                </div>

                <div class="form-group">
                    <label>出生时辰（大致即可）</label>
                    <select id="hour">
                        <option value="0">子时 23-01</option><option value="1">丑时 01-03</option>
                        <option value="3">寅时 03-05</option><option value="5">卯时 05-07</option>
                        <option value="7">辰时 07-09</option><option value="9">巳时 09-11</option>
                        <option value="11">午时 11-13</option><option value="13">未时 13-15</option>
                        <option value="15">申时 15-17</option><option value="17">酉时 17-19</option>
                        <option value="19">戌时 19-21</option><option value="21">亥时 21-23</option>
                        <option value="12" selected>未知（取中午）</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>性别</label>
                    <select id="gender">
                        <option value="male">男</option>
                        <option value="female">女</option>
                    </select>
                </div>

                <button onclick="calculateFortune()">开始推演</button>
            </div>

            <!-- 结果面板 -->
            <div id="resultContainer" class="result-panel result-hidden">
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab(event, 'tab-crypto')">币圈·土狗运势</button>
                    <button class="tab-btn" onclick="switchTab(event, 'tab-basic')">基础信息</button>
                    <button class="tab-btn" onclick="switchTab(event, 'tab-fortune')">运势指数</button>
                    <button class="tab-btn" onclick="switchTab(event, 'tab-detail')">详细报告</button>
                </div>

                <!-- 币圈·土狗运势 -->
                <div id="tab-crypto" class="tab-content active">
                    <div id="cryptoCard">
                        <h3>币圈·土狗运势（今天适合打土狗吗？）</h3>
                        <div id="cryptoAdvice"></div>
                    </div>
                </div>

                <!-- 基础信息 -->
                <div id="tab-basic" class="tab-content">
                    <div class="result-card">
                        <h3>八字排盘</h3>
                        <div id="baziDisplay" class="bazi-display"></div>
                    </div>

                    <div class="result-card">
                        <h3>五行分布</h3>
                        <div id="wuxingGrid" class="wuxing-grid"></div>
                    </div>
                </div>

                <!-- 运势指数 -->
                <div id="tab-fortune" class="tab-content">
                    <div class="result-card">
                        <h3>综合运势指数</h3>
                        <div class="fortune-bar-container">
                            <div class="fortune-bar-label"><span>综合运势</span><span id="overallValue">0%</span></div>
                            <div class="fortune-bar"><div id="overallBar" class="fortune-bar-fill" style="width:0%"></div></div>
                        </div>
                        <div class="fortune-bar-container">
                            <div class="fortune-bar-label"><span>财运</span><span id="wealthValue">0%</span></div>
                            <div class="fortune-bar"><div id="wealthBar" class="fortune-bar-fill" style="width:0%"></div></div>
                        </div>
                        <div class="fortune-bar-container">
                            <div class="fortune-bar-label"><span>事业运</span><span id="careerValue">0%</span></div>
                            <div class="fortune-bar"><div id="careerBar" class="fortune-bar-fill" style="width:0%"></div></div>
                        </div>
                        <div class="fortune-bar-container">
                            <div class="fortune-bar-label"><span>感情运</span><span id="loveValue">0%</span></div>
                            <div class="fortune-bar"><div id="loveBar" class="fortune-bar-fill" style="width:0%"></div></div>
                        </div>
                        <div class="fortune-bar-container">
                            <div class="fortune-bar-label"><span>健康运</span><span id="healthValue">0%</span></div>
                            <div class="fortune-bar"><div id="healthBar" class="fortune-bar-fill" style="width:0%"></div></div>
                        </div>
                    </div>
                </div>

                <!-- 详细报告 -->
                <div id="tab-detail" class="tab-content">
                    <div class="result-card"><h3>基础信息</h3><div id="basicInfo" class="analysis-text"></div></div>
                    <div class="result-card"><h3>八字分析</h3><div id="baziAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>五行分析</h3><div id="wuxingAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>综合运势</h3><div id="fortuneAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>财运分析</h3><div id="wealthAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>事业分析</h3><div id="careerAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>感情分析</h3><div id="loveAnalysis" class="analysis-text"></div></div>
                    <div class="result-card"><h3>健康建议</h3><div id="healthAdvice" class="analysis-text"></div></div>
                    <div class="result-card"><h3>逐月运势</h3><div id="monthlyFortune" class="analysis-text"></div></div>
                    <div class="result-card"><h3>改运建议</h3><div id="improveAdvice" class="analysis-text"></div></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        class FortuneEngine {
            constructor() {
                this.heavenStems = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
                this.earthBranches = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
                this.stemWuXing = { '甲': '木', '乙': '木', '丙': '火', '丁': '火', '戊': '土', '己': '土', '庚': '金', '辛': '金', '壬': '水', '癸': '水' };
                this.branchWuXing = { '子': '水', '丑': '土', '寅': '木', '卯': '木', '辰': '土', '巳': '火', '午': '火', '未': '土', '申': '金', '酉': '金', '戌': '土', '亥': '水' };
            }

            yearToGanZhi(year) {
                const stemIndex = (year - 4) % 10;
                const branchIndex = (year - 4) % 12;
                return this.heavenStems[stemIndex] + this.earthBranches[branchIndex];
            }

            monthToGanZhi(year, month) {
                const yearGanZhi = this.yearToGanZhi(year);
                const yearStemIndex = this.heavenStems.indexOf(yearGanZhi[0]);
                const monthStemIndex = (yearStemIndex * 2 + month + 1) % 10;
                const monthBranchIndex = month - 1;
                return this.heavenStems[monthStemIndex] + this.earthBranches[monthBranchIndex];
            }

            dayToGanZhi(year, month, day) {
                const base = new Date(1900, 0, 31);
                const current = new Date(year, month - 1, day);
                const days = Math.floor((current - base) / 86400000);
                const stemIndex = (days + 60) % 10;
                const branchIndex = (days + 60) % 12;
                return this.heavenStems[stemIndex] + this.earthBranches[branchIndex];
            }

            hourToGanZhi(dayGanZhi, hour) {
                const dayStemIndex = this.heavenStems.indexOf(dayGanZhi[0]);
                const hourBranchMap = [0,1,2,3,4,5,6,7,8,9,10,11];
                let hourBranchIndex = hourBranchMap[Math.floor(hour / 2)];
                if (hour === 23 || hour === 0) hourBranchIndex = 0;
                const hourStemIndex = (dayStemIndex * 2 + hourBranchIndex) % 10;
                return this.heavenStems[hourStemIndex] + this.earthBranches[hourBranchIndex];
            }

            getBaZi(year, month, day, hour) {
                const y = this.yearToGanZhi(year);
                const m = this.monthToGanZhi(year, month);
                const d = this.dayToGanZhi(year, month, day);
                const h = this.hourToGanZhi(d, hour);
                return { year: y, month: m, day: d, hour: h, full: `${y} ${m} ${d} ${h}` };
            }

            getWuXingCount(baZi) {
                const chars = (baZi.year + baZi.month + baZi.day + baZi.hour);
                const count = { '木': 0, '火': 0, '土': 0, '金': 0, '水': 0 };
                for (let c of chars) {
                    if (this.stemWuXing[c]) count[this.stemWuXing[c]]++;
                    if (this.branchWuXing[c]) count[this.branchWuXing[c]]++;
                }
                return count;
            }

            calculateDayMasterStrength(baZi) {
                const dm = baZi.day[0];
                const wx = this.stemWuXing[dm];
                let strength = 50;
                ['year','month','day','hour'].forEach(p => {
                    if (this.stemWuXing[baZi[p][0]] === wx) strength += (p === 'day' ? 30 : p === 'month' ? 20 : 15);
                    if (this.branchWuXing[baZi[p][1]] === wx) strength += (p === 'day' ? 20 : p === 'month' ? 15 : 10);
                });
                return Math.min(Math.round(strength), 100);
            }

            generateFortune(year, month, day, hour, gender) {
                const baZi = this.getBaZi(year, month, day, hour);
                const wuXingCount = this.getWuXingCount(baZi);
                const dayMasterStrength = this.calculateDayMasterStrength(baZi);
                const dayMasterWuXing = this.stemWuXing[baZi.day[0]];
                const today = new Date();
                let age = today.getFullYear() - year;
                if (today.getMonth() + 1 < month || (today.getMonth() + 1 === month && today.getDate() < day)) age--;

                const max = Math.max(...Object.values(wuXingCount));
                const min = Math.min(...Object.values(wuXingCount));
                const balance = max === 0 ? 50 : Math.round(100 - (max - min) * 12.5);

                const indices = {
                    overall: Math.round((dayMasterStrength + balance) / 2),
                    wealth: Math.min(Math.round((wuXingCount['木'] + wuXingCount['火']) * 12), 100),
                    career: Math.round(balance * 0.9),
                    love: Math.round(balance * 0.85),
                    health: dayMasterStrength,
                    balance: balance
                };

                return { baZi, wuXingCount, dayMasterStrength, dayMasterWuXing, age, gender, fortuneIndices: indices };
            }
        }

        class DetailedAnalysisGenerator {
            constructor() {
                this.wuXingDescriptions = {
                    '木': { 名称: '木', 颜色: '绿色', 方向: '东方', 季节: '春季', 器官: '肝胆', 情绪: '怒', 味道: '酸' },
                    '火': { 名称: '火', 颜色: '红色', 方向: '南方', 季节: '夏季', 器官: '心脑', 情绪: '喜', 味道: '苦' },
                    '土': { 名称: '土', 颜色: '黄色', 方向: '中央', 季节: '四季末', 器官: '脾胃', 情绪: '思', 味道: '甘' },
                    '金': { 名称: '金', 颜色: '白色', 方向: '西方', 季节: '秋季', 器官: '肺肠', 情绪: '悲', 味道: '辛' },
                    '水': { 名称: '水', 颜色: '黑色', 方向: '北方', 季节: '冬季', 器官: '肾膀胱', 情绪: '恐', 味道: '咸' }
                };
            }

            generateFullReport(fortune) {
                return {
                    基础信息: this.generateBasicInfo(fortune),
                    八字分析: this.generateBaZiAnalysis(fortune),
                    五行分析: this.generateWuXingAnalysis(fortune),
                    运势分析: this.generateFortuneAnalysis(fortune),
                    财运分析: this.generateWealthAnalysis(fortune),
                    事业分析: this.generateCareerAnalysis(fortune),
                    感情分析: this.generateLoveAnalysis(fortune),
                    健康建议: this.generateHealthAdvice(fortune),
                    币圈土狗运势: this.generateCryptoAdvice(fortune),
                    逐月运势: this.generateMonthlyFortune(fortune),
                    改运建议: this.generateImproveAdvice(fortune)
                };
            }

            generateBasicInfo(fortune) {
                return `年龄：${fortune.age}岁\n性别：${fortune.gender === 'male' ? '男' : '女'}\n八字：${fortune.baZi.full}\n日主：${fortune.baZi.day}\n日主五行：${fortune.dayMasterWuXing}\n日主强弱：${fortune.dayMasterStrength}分`;
            }

            generateBaZiAnalysis(fortune) {
                const { baZi, dayMasterStrength, dayMasterWuXing } = fortune;
                let text = `你的八字为：${baZi.full}\n\n日主（日干）为${baZi.day[0]}，属${dayMasterWuXing}性。\n\n`;
                if (dayMasterStrength > 70) text += `日主非常旺盛（${dayMasterStrength}分），天生自信、行动力强、领导力突出。你是天生的领导者，具有极强的执行力。`;
                else if (dayMasterStrength > 55) text += `日主较旺（${dayMasterStrength}分），具备良好自我管理能力，性格稳健，人格健全。`;
                else if (dayMasterStrength > 40) text += `日主中等（${dayMasterStrength}分），性格温和，适应力强，善于合作。`;
                else text += `日主偏弱（${dayMasterStrength}分），需借助外力与贵人，宜多建立人脉。`;
                return text;
            }

            generateWuXingAnalysis(fortune) {
                const { wuXingCount } = fortune;
                const total = Object.values(wuXingCount).reduce((a,b)=>a+b,0);
                let text = '五行分布：\n\n';
                for (let [wx, cnt] of Object.entries(wuXingCount)) {
                    const pct = Math.round(cnt/total*100);
                    const d = this.wuXingDescriptions[wx];
                    text += `${d.名称}：${cnt}个（${pct}%） → ${d.方向}、${d.季节}、${d.器官}\n`;
                }
                const diff = Math.max(...Object.values(wuXingCount)) - Math.min(...Object.values(wuXingCount));
                text += '\n五行平衡度：\n';
                if (diff <= 2) text += '非常均衡，先天条件极佳，性格平和，发展全面。';
                else if (diff <= 4) text += '基本均衡，稍作调理即可全面发展。';
                else text += '有所失衡，需针对性补救短板。';
                return text;
            }

            generateFortuneAnalysis(fortune) {
                const overall = fortune.fortuneIndices.overall;
                let text = `综合运势指数：${overall}/100\n\n详细指数：\n财运：${fortune.fortuneIndices.wealth}/100\n事业：${fortune.fortuneIndices.career}/100\n感情：${fortune.fortuneIndices.love}/100\n健康：${fortune.fortuneIndices.health}/100`;
                return text;
            }

            generateWealthAnalysis(fortune) {
                const strength = fortune.dayMasterStrength;
                let text = '财运分析：\n\n';
                if (strength > 70) text += '日主强势，聚财能力强，适合创业投资，把握商机可大富。';
                else if (strength < 40) text += '日主偏弱，宜守正财，稳定收入为主，避免投机。';
                else text += '财运中等，可稳中求进，适度理财。';
                text += `\n今年财运指数：${fortune.fortuneIndices.wealth}/100`;
                return text;
            }

            generateCareerAnalysis(fortune) {
                const wx = fortune.dayMasterWuXing;
                const paths = {
                    '木': ['教育、医疗、林业、设计、管理'],
                    '火': ['能源、科技、传媒、营销、法律'],
                    '土': ['地产、建筑、农业、公务员'],
                    '金': ['金融、机械、军警、珠宝'],
                    '水': ['贸易、旅游、物流、IT、艺术']
                };
                let text = `适合行业（依据${wx}属性）：\n` + (paths[wx] || ['多元行业']).map((p,i)=>`${i+1}. ${p}`).join('\n') + '\n\n';
                if (fortune.dayMasterStrength > 70) text += '宜创业或高层管理，领导力强。';
                else if (fortune.dayMasterStrength < 40) text += '宜稳定大平台，借贵人之力。';
                else text += '可创业也可深耕专业领域。';
                return text;
            }

            generateLoveAnalysis(fortune) {
                const traits = {
                    '木': '热情直率，但易固执。需多倾听与包容。',
                    '火': '浪漫激情，但情绪化。需增加耐心。',
                    '土': '忠诚可靠，但少浪漫。需多表达情感。',
                    '金': '理性专一，但显冷淡。需主动示暖。',
                    '水': '温柔体贴，但多敏感。需增强自信。'
                };
                let text = `感情特质：${traits[fortune.dayMasterWuXing] || '需用心经营'}\n\n今年感情运：${fortune.fortuneIndices.love > 70 ? '极佳，易遇正缘或婚姻美满' : fortune.fortuneIndices.love > 50 ? '平稳，可遇良缘' : '需主动，多沟通'}`;
                return text;
            }

            generateHealthAdvice(fortune) {
                const tips = {
                    '木': {器官:'肝胆', 注意:'防怒伤肝、过度劳累', 调理:'春季运动、多绿植'},
                    '火': {器官:'心血管', 注意:'防心火、上火', 调理:'夏季清热、静心'},
                    '土': {器官:'脾胃', 注意:'饮食规律、防湿重', 调理:'健脾祛湿'},
                    '金': {器官:'肺呼吸', 注意:'防秋燥、悲伤', 调理:'润肺养阴'},
                    '水': {器官:'肾泌尿', 注意:'防寒、肾虚', 调理:'冬季补肾、保暖'}
                };
                const t = tips[fortune.dayMasterWuXing];
                return `重点关注：${t.器官}\n注意事项：${t.注意}\n调理建议：${t.调理}\n今年健康指数：${fortune.fortuneIndices.health}/100`;
            }

            generateCryptoAdvice(fortune) {
                const wealth = fortune.fortuneIndices.wealth;
                const overall = fortune.fortuneIndices.overall;
                const wx = fortune.dayMasterWuXing;
                const strength = fortune.dayMasterStrength;

                let advice = '币圈·土狗运势分析（纯娱乐，投资有风险）\n\n';

                const wxStyle = {
                    '木': '成长型项目，适合长线埋伏新叙事（如Layer2、AI链）',
                    '火': '热点爆炒，今天容易短线吃肉（meme、热搜概念）',
                    '土': '宜持蓝筹稳定币，土狗风险高（BTC/ETH为主）',
                    '金': '高风险高收益，适合重仓梭哈潜力宝石',
                    '水': '流动性强，适合快进快出波段（DEX、衍生品）'
                };
                advice += `你的日主五行【${wx}】：${wxStyle[wx] || '灵活应变，随机应变'}\n\n`;

                if (wealth > 85 && overall > 75) {
                    advice += '今日土狗运极佳！财星高照，贵人运爆棚！\n非常适合打土狗、上新、上所项目，容易吃到大肉！\n建议：重仓潜力 meme / 新叙事，敢梭哈敢暴富！\n记得见好就收，落袋为安！';
                } else if (wealth > 70) {
                    advice += '土狗运很不错，有小惊喜！\n今天适合打土狗，轻仓试水热点项目很容易吃肉。\n推荐关注 Solana/Base/BSC 新 meme，跟KOL走大概率盈利。\n策略：设置止盈止损，玩得开心。';
                } else if (wealth > 50) {
                    advice += '土狗运中等，市场震荡。\n可以小玩怡情，但不建议重仓打土狗。\n更适合埋伏蓝筹或老 meme，避免追高。\n耐心等回调再出手。';
                } else if (wealth > 30) {
                    advice += '土狗运偏弱，容易被割。\n今天不建议打新土狗，容易站岗。\n推荐观望或只用娱乐资金玩老项目。\n多学习，等待更好时机。';
                } else {
                    advice += '今日土狗运很差，强烈不建议打土狗！\n容易接盘、被套，FOMO 必亏。\n建议持币休息，或只持 BTC/ETH 大币。\n耐心等大运到来，币圈最忌急躁。';
                }

                advice += `\n\n今日财运指数：${wealth}/100（越高越适合投机）`;

                if (strength > 70) {
                    advice += '\n日主强势：你天生适合高风险操作，把握节奏易大成！';
                } else if (strength < 40) {
                    advice += '\n日主偏弱：建议保守策略，避免过度投机。';
                }

                return advice;
            }

            generateMonthlyFortune(fortune) {
                const months = ['1','2','3','4','5','6','7','8','9','10','11','12'];
                let text = '2026年逐月运势简评：\n\n';
                months.forEach((m,i) => {
                    const score = Math.round(50 + Math.sin(i) * 20 + fortune.age % 10 * 3 + i * 2);
                    const level = score > 75 ? '极佳' : score > 60 ? '顺利' : score > 45 ? '平稳' : '注意';
                    text += `${m}月：${score}分 - ${level}\n`;
                });
                return text;
            }

            generateImproveAdvice(fortune) {
                const color = { '木':'绿色', '火':'红色', '土':'黄色', '金':'白色', '水':'黑色' }[fortune.dayMasterWuXing];
                return `1. 颜色调理：多穿${color}系衣物、装饰\n2. 方位调理：宜向${this.wuXingDescriptions[fortune.dayMasterWuXing].方向}发展\n3. 生活习惯：早睡早起、适度运动、行善积德\n4. 人际贵人：多结善缘，寻求日主同五行之人相助`;
            }
        }

        const engine = new FortuneEngine();
        const generator = new DetailedAnalysisGenerator();

        function calculateFortune() {
            const year = parseInt(document.getElementById('year').value);
            const month = parseInt(document.getElementById('month').value);
            const day = parseInt(document.getElementById('day').value);
            const hour = parseInt(document.getElementById('hour').value);
            const gender = document.getElementById('gender').value;

            const fortune = engine.generateFortune(year, month, day, hour, gender);
            const report = generator.generateFullReport(fortune);

            document.getElementById('resultContainer').classList.remove('result-hidden');

            document.getElementById('baziDisplay').innerHTML = `
                <div>年柱：${fortune.baZi.year}</div>
                <div>月柱：${fortune.baZi.month}</div>
                <div>日柱：${fortune.baZi.day}</div>
                <div>时柱：${fortune.baZi.hour}</div>
            `;

            const wxOrder = ['木','火','土','金','水'];
            document.getElementById('wuxingGrid').innerHTML = wxOrder.map(w => `
                <div class="wuxing-item">
                    <div>${w}</div>
                    <div class="wuxing-count">${fortune.wuXingCount[w]}</div>
                </div>
            `).join('');

            const idx = fortune.fortuneIndices;
            ['overall','wealth','career','love','health'].forEach(k => {
                document.getElementById(k+'Value').textContent = idx[k] + '%';
                document.getElementById(k+'Bar').style.width = idx[k] + '%';
            });

            document.getElementById('basicInfo').textContent = report.基础信息;
            document.getElementById('baziAnalysis').textContent = report.八字分析;
            document.getElementById('wuxingAnalysis').textContent = report.五行分析;
            document.getElementById('fortuneAnalysis').textContent = report.运势分析;
            document.getElementById('wealthAnalysis').textContent = report.财运分析;
            document.getElementById('careerAnalysis').textContent = report.事业分析;
            document.getElementById('loveAnalysis').textContent = report.感情分析;
            document.getElementById('healthAdvice').textContent = report.健康建议;
            document.getElementById('cryptoAdvice').textContent = report.币圈土狗运势;
            document.getElementById('monthlyFortune').textContent = report.逐月运势;
            document.getElementById('improveAdvice').textContent = report.改运建议;

            switchTab(null, 'tab-crypto');
        }

        function switchTab(e, tabName) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            if (e) e.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            document.querySelector(`.tab-btn[onclick="switchTab(event, '${tabName}')"]`).classList.add('active');
        }

        function initDays() {
            const daySelect = document.getElementById('day');
            daySelect.innerHTML = '';
            const daysInMonth = new Date(document.getElementById('year').value, document.getElementById('month').value, 0).getDate();
            for (let i = 1; i <= daysInMonth; i++) {
                daySelect.innerHTML += `<option value="${i}">${i}日</option>`;
            }
        }
        document.getElementById('year').addEventListener('change', initDays);
        document.getElementById('month').addEventListener('change', initDays);
        initDays();
        document.getElementById('day').value = new Date().getDate();
    </script>
</body>
</html>